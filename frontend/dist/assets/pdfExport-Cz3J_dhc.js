import{g as nt,j as rt,c as q,E as it}from"./index-GfXu0VJd.js";import at from"./html2canvas.esm-CBrSDip1.js";var ot={exports:{}};const lt=nt(rt);/*!
 * 
 *               jsPDF AutoTable plugin v3.8.4
 *
 *               Copyright (c) 2024 Simon Bengtsson, https://github.com/simonbengtsson/jsPDF-AutoTable
 *               Licensed under the MIT License.
 *               http://opensource.org/licenses/mit-license
 *
 */(function(S,I){(function(E,O){S.exports=O(function(){try{return lt}catch{}}())})(typeof globalThis<"u"?globalThis:typeof q<"u"?q:typeof window<"u"?window:typeof self<"u"?self:q,function(R){return function(){var E={172:function(T,d){var H=this&&this.__extends||function(){var p=function(P,i){return p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,m){b.__proto__=m}||function(b,m){for(var u in m)Object.prototype.hasOwnProperty.call(m,u)&&(b[u]=m[u])},p(P,i)};return function(P,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");p(P,i);function b(){this.constructor=P}P.prototype=i===null?Object.create(i):(b.prototype=i.prototype,new b)}}();Object.defineProperty(d,"__esModule",{value:!0}),d.CellHookData=d.HookData=void 0;var F=function(){function p(P,i,b){this.table=i,this.pageNumber=i.pageNumber,this.pageCount=this.pageNumber,this.settings=i.settings,this.cursor=b,this.doc=P.getDocument()}return p}();d.HookData=F;var w=function(p){H(P,p);function P(i,b,m,u,r,t){var e=p.call(this,i,b,t)||this;return e.cell=m,e.row=u,e.column=r,e.section=u.section,e}return P}(F);d.CellHookData=w},340:function(T,d,H){Object.defineProperty(d,"__esModule",{value:!0});var F=H(4),w=H(136),p=H(744),P=H(776),i=H(664),b=H(972);function m(u){u.API.autoTable=function(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];var e;r.length===1?e=r[0]:(console.error("Use of deprecated autoTable initiation"),e=r[2]||{},e.columns=r[0],e.body=r[1]);var l=(0,P.parseInput)(this,e),s=(0,b.createTable)(this,l);return(0,i.drawTable)(this,s),this},u.API.lastAutoTable=!1,u.API.previousAutoTable=!1,u.API.autoTable.previous=!1,u.API.autoTableText=function(r,t,e,l){(0,w.default)(r,t,e,l,this)},u.API.autoTableSetDefaults=function(r){return p.DocHandler.setDefaults(r,this),this},u.autoTableSetDefaults=function(r,t){p.DocHandler.setDefaults(r,t)},u.API.autoTableHtmlToJson=function(r,t){var e;if(t===void 0&&(t=!1),typeof window>"u")return console.error("Cannot run autoTableHtmlToJson in non browser environment"),null;var l=new p.DocHandler(this),s=(0,F.parseHtml)(l,r,window,t,!1),n=s.head,f=s.body,c=((e=n[0])===null||e===void 0?void 0:e.map(function(y){return y.content}))||[];return{columns:c,rows:f,data:f}},u.API.autoTableEndPosY=function(){console.error("Use of deprecated function: autoTableEndPosY. Use doc.lastAutoTable.finalY instead.");var r=this.lastAutoTable;return r&&r.finalY?r.finalY:0},u.API.autoTableAddPageContent=function(r){return console.error("Use of deprecated function: autoTableAddPageContent. Use jsPDF.autoTableSetDefaults({didDrawPage: () => {}}) instead."),u.API.autoTable.globalDefaults||(u.API.autoTable.globalDefaults={}),u.API.autoTable.globalDefaults.addPageContent=r,this},u.API.autoTableAddPage=function(){return console.error("Use of deprecated function: autoTableAddPage. Use doc.addPage()"),this.addPage(),this}}d.default=m},136:function(T,d){Object.defineProperty(d,"__esModule",{value:!0});function H(F,w,p,P,i){P=P||{};var b=1.15,m=i.internal.scaleFactor,u=i.internal.getFontSize()/m,r=i.getLineHeightFactor?i.getLineHeightFactor():b,t=u*r,e=/\r\n|\r|\n/g,l="",s=1;if((P.valign==="middle"||P.valign==="bottom"||P.halign==="center"||P.halign==="right")&&(l=typeof F=="string"?F.split(e):F,s=l.length||1),p+=u*(2-b),P.valign==="middle"?p-=s/2*t:P.valign==="bottom"&&(p-=s*t),P.halign==="center"||P.halign==="right"){var n=u;if(P.halign==="center"&&(n*=.5),l&&s>=1){for(var f=0;f<l.length;f++)i.text(l[f],w-i.getStringUnitWidth(l[f])*n,p),p+=t;return i}w-=i.getStringUnitWidth(F)*n}return P.halign==="justify"?i.text(F,w,p,{maxWidth:P.maxWidth||100,align:"justify"}):i.text(F,w,p),i}d.default=H},420:function(T,d){Object.defineProperty(d,"__esModule",{value:!0}),d.getPageAvailableWidth=d.parseSpacing=d.getFillStyle=d.addTableBorder=d.getStringWidth=void 0;function H(i,b,m){m.applyStyles(b,!0);var u=Array.isArray(i)?i:[i],r=u.map(function(t){return m.getTextWidth(t)}).reduce(function(t,e){return Math.max(t,e)},0);return r}d.getStringWidth=H;function F(i,b,m,u){var r=b.settings.tableLineWidth,t=b.settings.tableLineColor;i.applyStyles({lineWidth:r,lineColor:t});var e=w(r,!1);e&&i.rect(m.x,m.y,b.getWidth(i.pageSize().width),u.y-m.y,e)}d.addTableBorder=F;function w(i,b){var m=i>0,u=b||b===0;return m&&u?"DF":m?"S":u?"F":null}d.getFillStyle=w;function p(i,b){var m,u,r,t;if(i=i||b,Array.isArray(i)){if(i.length>=4)return{top:i[0],right:i[1],bottom:i[2],left:i[3]};if(i.length===3)return{top:i[0],right:i[1],bottom:i[2],left:i[1]};if(i.length===2)return{top:i[0],right:i[1],bottom:i[0],left:i[1]};i.length===1?i=i[0]:i=b}return typeof i=="object"?(typeof i.vertical=="number"&&(i.top=i.vertical,i.bottom=i.vertical),typeof i.horizontal=="number"&&(i.right=i.horizontal,i.left=i.horizontal),{left:(m=i.left)!==null&&m!==void 0?m:b,top:(u=i.top)!==null&&u!==void 0?u:b,right:(r=i.right)!==null&&r!==void 0?r:b,bottom:(t=i.bottom)!==null&&t!==void 0?t:b}):(typeof i!="number"&&(i=b),{top:i,right:i,bottom:i,left:i})}d.parseSpacing=p;function P(i,b){var m=p(b.settings.margin,0);return i.pageSize().width-(m.left+m.right)}d.getPageAvailableWidth=P},796:function(T,d){var H=this&&this.__extends||function(){var P=function(i,b){return P=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(m,u){m.__proto__=u}||function(m,u){for(var r in u)Object.prototype.hasOwnProperty.call(u,r)&&(m[r]=u[r])},P(i,b)};return function(i,b){if(typeof b!="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");P(i,b);function m(){this.constructor=i}i.prototype=b===null?Object.create(b):(m.prototype=b.prototype,new m)}}();Object.defineProperty(d,"__esModule",{value:!0}),d.getTheme=d.defaultStyles=d.HtmlRowInput=void 0;var F=function(P){H(i,P);function i(b){var m=P.call(this)||this;return m._element=b,m}return i}(Array);d.HtmlRowInput=F;function w(P){return{font:"helvetica",fontStyle:"normal",overflow:"linebreak",fillColor:!1,textColor:20,halign:"left",valign:"top",fontSize:10,cellPadding:5/P,lineColor:200,lineWidth:0,cellWidth:"auto",minCellHeight:0,minCellWidth:0}}d.defaultStyles=w;function p(P){var i={striped:{table:{fillColor:255,textColor:80,fontStyle:"normal"},head:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},body:{},foot:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,textColor:80,fontStyle:"normal",lineWidth:.1},head:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},body:{},foot:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},alternateRow:{}},plain:{head:{fontStyle:"bold"},foot:{fontStyle:"bold"}}};return i[P]}d.getTheme=p},903:function(T,d,H){Object.defineProperty(d,"__esModule",{value:!0}),d.parseCss=void 0;var F=H(420);function w(m,u,r,t,e){var l={},s=1.3333333333333333,n=P(u,function(g){return e.getComputedStyle(g).backgroundColor});n!=null&&(l.fillColor=n);var f=P(u,function(g){return e.getComputedStyle(g).color});f!=null&&(l.textColor=f);var c=b(t,r);c&&(l.cellPadding=c);var y="borderTopColor",v=s*r,o=t.borderTopWidth;if(t.borderBottomWidth===o&&t.borderRightWidth===o&&t.borderLeftWidth===o){var W=(parseFloat(o)||0)/v;W&&(l.lineWidth=W)}else l.lineWidth={top:(parseFloat(t.borderTopWidth)||0)/v,right:(parseFloat(t.borderRightWidth)||0)/v,bottom:(parseFloat(t.borderBottomWidth)||0)/v,left:(parseFloat(t.borderLeftWidth)||0)/v},l.lineWidth.top||(l.lineWidth.right?y="borderRightColor":l.lineWidth.bottom?y="borderBottomColor":l.lineWidth.left&&(y="borderLeftColor"));var z=P(u,function(g){return e.getComputedStyle(g)[y]});z!=null&&(l.lineColor=z);var B=["left","right","center","justify"];B.indexOf(t.textAlign)!==-1&&(l.halign=t.textAlign),B=["middle","bottom","top"],B.indexOf(t.verticalAlign)!==-1&&(l.valign=t.verticalAlign);var h=parseInt(t.fontSize||"");isNaN(h)||(l.fontSize=h/s);var a=p(t);a&&(l.fontStyle=a);var C=(t.fontFamily||"").toLowerCase();return m.indexOf(C)!==-1&&(l.font=C),l}d.parseCss=w;function p(m){var u="";return(m.fontWeight==="bold"||m.fontWeight==="bolder"||parseInt(m.fontWeight)>=700)&&(u="bold"),(m.fontStyle==="italic"||m.fontStyle==="oblique")&&(u+="italic"),u}function P(m,u){var r=i(m,u);if(!r)return null;var t=r.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d*))?\)$/);if(!t||!Array.isArray(t))return null;var e=[parseInt(t[1]),parseInt(t[2]),parseInt(t[3])],l=parseInt(t[4]);return l===0||isNaN(e[0])||isNaN(e[1])||isNaN(e[2])?null:e}function i(m,u){var r=u(m);return r==="rgba(0, 0, 0, 0)"||r==="transparent"||r==="initial"||r==="inherit"?m.parentElement==null?null:i(m.parentElement,u):r}function b(m,u){var r=[m.paddingTop,m.paddingRight,m.paddingBottom,m.paddingLeft],t=96/(72/u),e=(parseInt(m.lineHeight)-parseInt(m.fontSize))/u/2,l=r.map(function(n){return parseInt(n||"0")/t}),s=(0,F.parseSpacing)(l,0);return e>s.top&&(s.top=e),e>s.bottom&&(s.bottom=e),s}},744:function(T,d){Object.defineProperty(d,"__esModule",{value:!0}),d.DocHandler=void 0;var H={},F=function(){function w(p){this.jsPDFDocument=p,this.userStyles={textColor:p.getTextColor?this.jsPDFDocument.getTextColor():0,fontSize:p.internal.getFontSize(),fontStyle:p.internal.getFont().fontStyle,font:p.internal.getFont().fontName,lineWidth:p.getLineWidth?this.jsPDFDocument.getLineWidth():0,lineColor:p.getDrawColor?this.jsPDFDocument.getDrawColor():0}}return w.setDefaults=function(p,P){P===void 0&&(P=null),P?P.__autoTableDocumentDefaults=p:H=p},w.unifyColor=function(p){return Array.isArray(p)?p:typeof p=="number"?[p,p,p]:typeof p=="string"?[p]:null},w.prototype.applyStyles=function(p,P){var i,b,m;P===void 0&&(P=!1),p.fontStyle&&this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(p.fontStyle);var u=this.jsPDFDocument.internal.getFont(),r=u.fontStyle,t=u.fontName;if(p.font&&(t=p.font),p.fontStyle){r=p.fontStyle;var e=this.getFontList()[t];e&&e.indexOf(r)===-1&&(this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(e[0]),r=e[0])}if(this.jsPDFDocument.setFont(t,r),p.fontSize&&this.jsPDFDocument.setFontSize(p.fontSize),!P){var l=w.unifyColor(p.fillColor);l&&(i=this.jsPDFDocument).setFillColor.apply(i,l),l=w.unifyColor(p.textColor),l&&(b=this.jsPDFDocument).setTextColor.apply(b,l),l=w.unifyColor(p.lineColor),l&&(m=this.jsPDFDocument).setDrawColor.apply(m,l),typeof p.lineWidth=="number"&&this.jsPDFDocument.setLineWidth(p.lineWidth)}},w.prototype.splitTextToSize=function(p,P,i){return this.jsPDFDocument.splitTextToSize(p,P,i)},w.prototype.rect=function(p,P,i,b,m){return this.jsPDFDocument.rect(p,P,i,b,m)},w.prototype.getLastAutoTable=function(){return this.jsPDFDocument.lastAutoTable||null},w.prototype.getTextWidth=function(p){return this.jsPDFDocument.getTextWidth(p)},w.prototype.getDocument=function(){return this.jsPDFDocument},w.prototype.setPage=function(p){this.jsPDFDocument.setPage(p)},w.prototype.addPage=function(){return this.jsPDFDocument.addPage()},w.prototype.getFontList=function(){return this.jsPDFDocument.getFontList()},w.prototype.getGlobalOptions=function(){return H||{}},w.prototype.getDocumentOptions=function(){return this.jsPDFDocument.__autoTableDocumentDefaults||{}},w.prototype.pageSize=function(){var p=this.jsPDFDocument.internal.pageSize;return p.width==null&&(p={width:p.getWidth(),height:p.getHeight()}),p},w.prototype.scaleFactor=function(){return this.jsPDFDocument.internal.scaleFactor},w.prototype.getLineHeightFactor=function(){var p=this.jsPDFDocument;return p.getLineHeightFactor?p.getLineHeightFactor():1.15},w.prototype.getLineHeight=function(p){return p/this.scaleFactor()*this.getLineHeightFactor()},w.prototype.pageNumber=function(){var p=this.jsPDFDocument.internal.getCurrentPageInfo();return p?p.pageNumber:this.jsPDFDocument.internal.getNumberOfPages()},w}();d.DocHandler=F},4:function(T,d,H){Object.defineProperty(d,"__esModule",{value:!0}),d.parseHtml=void 0;var F=H(903),w=H(796);function p(b,m,u,r,t){var e,l;r===void 0&&(r=!1),t===void 0&&(t=!1);var s;typeof m=="string"?s=u.document.querySelector(m):s=m;var n=Object.keys(b.getFontList()),f=b.scaleFactor(),c=[],y=[],v=[];if(!s)return console.error("Html table could not be found with input: ",m),{head:c,body:y,foot:v};for(var o=0;o<s.rows.length;o++){var W=s.rows[o],z=(l=(e=W==null?void 0:W.parentElement)===null||e===void 0?void 0:e.tagName)===null||l===void 0?void 0:l.toLowerCase(),B=P(n,f,u,W,r,t);B&&(z==="thead"?c.push(B):z==="tfoot"?v.push(B):y.push(B))}return{head:c,body:y,foot:v}}d.parseHtml=p;function P(b,m,u,r,t,e){for(var l=new w.HtmlRowInput(r),s=0;s<r.cells.length;s++){var n=r.cells[s],f=u.getComputedStyle(n);if(t||f.display!=="none"){var c=void 0;e&&(c=(0,F.parseCss)(b,n,m,f,u)),l.push({rowSpan:n.rowSpan,colSpan:n.colSpan,styles:c,_element:n,content:i(n)})}}var y=u.getComputedStyle(r);if(l.length>0&&(t||y.display!=="none"))return l}function i(b){var m=b.cloneNode(!0);return m.innerHTML=m.innerHTML.replace(/\n/g,"").replace(/ +/g," "),m.innerHTML=m.innerHTML.split(/<br.*?>/).map(function(u){return u.trim()}).join(`
`),m.innerText||m.textContent||""}},776:function(T,d,H){Object.defineProperty(d,"__esModule",{value:!0}),d.parseInput=void 0;var F=H(4),w=H(356),p=H(420),P=H(744),i=H(792);function b(s,n){var f=new P.DocHandler(s),c=f.getDocumentOptions(),y=f.getGlobalOptions();(0,i.default)(f,y,c,n);var v=(0,w.assign)({},y,c,n),o;typeof window<"u"&&(o=window);var W=m(y,c,n),z=u(y,c,n),B=r(f,v),h=e(f,v,o);return{id:n.tableId,content:h,hooks:z,styles:W,settings:B}}d.parseInput=b;function m(s,n,f){for(var c={styles:{},headStyles:{},bodyStyles:{},footStyles:{},alternateRowStyles:{},columnStyles:{}},y=function(z){if(z==="columnStyles"){var B=s[z],h=n[z],a=f[z];c.columnStyles=(0,w.assign)({},B,h,a)}else{var C=[s,n,f],g=C.map(function(x){return x[z]||{}});c[z]=(0,w.assign)({},g[0],g[1],g[2])}},v=0,o=Object.keys(c);v<o.length;v++){var W=o[v];y(W)}return c}function u(s,n,f){for(var c=[s,n,f],y={didParseCell:[],willDrawCell:[],didDrawCell:[],willDrawPage:[],didDrawPage:[]},v=0,o=c;v<o.length;v++){var W=o[v];W.didParseCell&&y.didParseCell.push(W.didParseCell),W.willDrawCell&&y.willDrawCell.push(W.willDrawCell),W.didDrawCell&&y.didDrawCell.push(W.didDrawCell),W.willDrawPage&&y.willDrawPage.push(W.willDrawPage),W.didDrawPage&&y.didDrawPage.push(W.didDrawPage)}return y}function r(s,n){var f,c,y,v,o,W,z,B,h,a,C,g,x=(0,p.parseSpacing)(n.margin,40/s.scaleFactor()),D=(f=t(s,n.startY))!==null&&f!==void 0?f:x.top,k;n.showFoot===!0?k="everyPage":n.showFoot===!1?k="never":k=(c=n.showFoot)!==null&&c!==void 0?c:"everyPage";var _;n.showHead===!0?_="everyPage":n.showHead===!1?_="never":_=(y=n.showHead)!==null&&y!==void 0?y:"everyPage";var M=(v=n.useCss)!==null&&v!==void 0?v:!1,j=n.theme||(M?"plain":"striped"),A=!!n.horizontalPageBreak,Y=(o=n.horizontalPageBreakRepeat)!==null&&o!==void 0?o:null;return{includeHiddenHtml:(W=n.includeHiddenHtml)!==null&&W!==void 0?W:!1,useCss:M,theme:j,startY:D,margin:x,pageBreak:(z=n.pageBreak)!==null&&z!==void 0?z:"auto",rowPageBreak:(B=n.rowPageBreak)!==null&&B!==void 0?B:"auto",tableWidth:(h=n.tableWidth)!==null&&h!==void 0?h:"auto",showHead:_,showFoot:k,tableLineWidth:(a=n.tableLineWidth)!==null&&a!==void 0?a:0,tableLineColor:(C=n.tableLineColor)!==null&&C!==void 0?C:200,horizontalPageBreak:A,horizontalPageBreakRepeat:Y,horizontalPageBreakBehaviour:(g=n.horizontalPageBreakBehaviour)!==null&&g!==void 0?g:"afterAllRows"}}function t(s,n){var f=s.getLastAutoTable(),c=s.scaleFactor(),y=s.pageNumber(),v=!1;if(f&&f.startPageNumber){var o=f.startPageNumber+f.pageNumber-1;v=o===y}return typeof n=="number"?n:(n==null||n===!1)&&v&&(f==null?void 0:f.finalY)!=null?f.finalY+20/c:null}function e(s,n,f){var c=n.head||[],y=n.body||[],v=n.foot||[];if(n.html){var o=n.includeHiddenHtml;if(f){var W=(0,F.parseHtml)(s,n.html,f,o,n.useCss)||{};c=W.head||c,y=W.body||c,v=W.foot||c}else console.error("Cannot parse html in non browser environment")}var z=n.columns||l(c,y,v);return{columns:z,head:c,body:y,foot:v}}function l(s,n,f){var c=s[0]||n[0]||f[0]||[],y=[];return Object.keys(c).filter(function(v){return v!=="_element"}).forEach(function(v){var o=1,W;Array.isArray(c)?W=c[parseInt(v)]:W=c[v],typeof W=="object"&&!Array.isArray(W)&&(o=(W==null?void 0:W.colSpan)||1);for(var z=0;z<o;z++){var B=void 0;Array.isArray(c)?B=y.length:B=v+(z>0?"_".concat(z):"");var h={dataKey:B};y.push(h)}}),y}},792:function(T,d){Object.defineProperty(d,"__esModule",{value:!0});function H(w,p,P,i){for(var b=function(t){t&&typeof t!="object"&&console.error("The options parameter should be of type object, is: "+typeof t),typeof t.extendWidth<"u"&&(t.tableWidth=t.extendWidth?"auto":"wrap",console.error("Use of deprecated option: extendWidth, use tableWidth instead.")),typeof t.margins<"u"&&(typeof t.margin>"u"&&(t.margin=t.margins),console.error("Use of deprecated option: margins, use margin instead.")),t.startY&&typeof t.startY!="number"&&(console.error("Invalid value for startY option",t.startY),delete t.startY),!t.didDrawPage&&(t.afterPageContent||t.beforePageContent||t.afterPageAdd)&&(console.error("The afterPageContent, beforePageContent and afterPageAdd hooks are deprecated. Use didDrawPage instead"),t.didDrawPage=function(v){w.applyStyles(w.userStyles),t.beforePageContent&&t.beforePageContent(v),w.applyStyles(w.userStyles),t.afterPageContent&&t.afterPageContent(v),w.applyStyles(w.userStyles),t.afterPageAdd&&v.pageNumber>1&&v.afterPageAdd(v),w.applyStyles(w.userStyles)}),["createdHeaderCell","drawHeaderRow","drawRow","drawHeaderCell"].forEach(function(v){t[v]&&console.error('The "'.concat(v,'" hook has changed in version 3.0, check the changelog for how to migrate.'))}),[["showFoot","showFooter"],["showHead","showHeader"],["didDrawPage","addPageContent"],["didParseCell","createdCell"],["headStyles","headerStyles"]].forEach(function(v){var o=v[0],W=v[1];t[W]&&(console.error("Use of deprecated option ".concat(W,". Use ").concat(o," instead")),t[o]=t[W])}),[["padding","cellPadding"],["lineHeight","rowHeight"],"fontSize","overflow"].forEach(function(v){var o=typeof v=="string"?v:v[0],W=typeof v=="string"?v:v[1];typeof t[o]<"u"&&(typeof t.styles[W]>"u"&&(t.styles[W]=t[o]),console.error("Use of deprecated option: "+o+", use the style "+W+" instead."))});for(var e=0,l=["styles","bodyStyles","headStyles","footStyles"];e<l.length;e++){var s=l[e];F(t[s]||{})}for(var n=t.columnStyles||{},f=0,c=Object.keys(n);f<c.length;f++){var y=c[f];F(n[y]||{})}},m=0,u=[p,P,i];m<u.length;m++){var r=u[m];b(r)}}d.default=H;function F(w){w.rowHeight?(console.error("Use of deprecated style rowHeight. It is renamed to minCellHeight."),w.minCellHeight||(w.minCellHeight=w.rowHeight)):w.columnWidth&&(console.error("Use of deprecated style columnWidth. It is renamed to cellWidth."),w.cellWidth||(w.cellWidth=w.columnWidth))}},260:function(T,d,H){Object.defineProperty(d,"__esModule",{value:!0}),d.Column=d.Cell=d.Row=d.Table=void 0;var F=H(796),w=H(172),p=H(420),P=function(){function u(r,t){this.pageNumber=1,this.pageCount=1,this.id=r.id,this.settings=r.settings,this.styles=r.styles,this.hooks=r.hooks,this.columns=t.columns,this.head=t.head,this.body=t.body,this.foot=t.foot}return u.prototype.getHeadHeight=function(r){return this.head.reduce(function(t,e){return t+e.getMaxCellHeight(r)},0)},u.prototype.getFootHeight=function(r){return this.foot.reduce(function(t,e){return t+e.getMaxCellHeight(r)},0)},u.prototype.allRows=function(){return this.head.concat(this.body).concat(this.foot)},u.prototype.callCellHooks=function(r,t,e,l,s,n){for(var f=0,c=t;f<c.length;f++){var y=c[f],v=new w.CellHookData(r,this,e,l,s,n),o=y(v)===!1;if(e.text=Array.isArray(e.text)?e.text:[e.text],o)return!1}return!0},u.prototype.callEndPageHooks=function(r,t){r.applyStyles(r.userStyles);for(var e=0,l=this.hooks.didDrawPage;e<l.length;e++){var s=l[e];s(new w.HookData(r,this,t))}},u.prototype.callWillDrawPageHooks=function(r,t){for(var e=0,l=this.hooks.willDrawPage;e<l.length;e++){var s=l[e];s(new w.HookData(r,this,t))}},u.prototype.getWidth=function(r){if(typeof this.settings.tableWidth=="number")return this.settings.tableWidth;if(this.settings.tableWidth==="wrap"){var t=this.columns.reduce(function(l,s){return l+s.wrappedWidth},0);return t}else{var e=this.settings.margin;return r-e.left-e.right}},u}();d.Table=P;var i=function(){function u(r,t,e,l,s){s===void 0&&(s=!1),this.height=0,this.raw=r,r instanceof F.HtmlRowInput&&(this.raw=r._element,this.element=r._element),this.index=t,this.section=e,this.cells=l,this.spansMultiplePages=s}return u.prototype.getMaxCellHeight=function(r){var t=this;return r.reduce(function(e,l){var s;return Math.max(e,((s=t.cells[l.index])===null||s===void 0?void 0:s.height)||0)},0)},u.prototype.hasRowSpan=function(r){var t=this;return r.filter(function(e){var l=t.cells[e.index];return l?l.rowSpan>1:!1}).length>0},u.prototype.canEntireRowFit=function(r,t){return this.getMaxCellHeight(t)<=r},u.prototype.getMinimumRowHeight=function(r,t){var e=this;return r.reduce(function(l,s){var n=e.cells[s.index];if(!n)return 0;var f=t.getLineHeight(n.styles.fontSize),c=n.padding("vertical"),y=c+f;return y>l?y:l},0)},u}();d.Row=i;var b=function(){function u(r,t,e){var l,s;this.contentHeight=0,this.contentWidth=0,this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.height=0,this.x=0,this.y=0,this.styles=t,this.section=e,this.raw=r;var n=r;r!=null&&typeof r=="object"&&!Array.isArray(r)?(this.rowSpan=r.rowSpan||1,this.colSpan=r.colSpan||1,n=(s=(l=r.content)!==null&&l!==void 0?l:r.title)!==null&&s!==void 0?s:r,r._element&&(this.raw=r._element)):(this.rowSpan=1,this.colSpan=1);var f=n!=null?""+n:"",c=/\r\n|\r|\n/g;this.text=f.split(c)}return u.prototype.getTextPos=function(){var r;if(this.styles.valign==="top")r=this.y+this.padding("top");else if(this.styles.valign==="bottom")r=this.y+this.height-this.padding("bottom");else{var t=this.height-this.padding("vertical");r=this.y+t/2+this.padding("top")}var e;if(this.styles.halign==="right")e=this.x+this.width-this.padding("right");else if(this.styles.halign==="center"){var l=this.width-this.padding("horizontal");e=this.x+l/2+this.padding("left")}else e=this.x+this.padding("left");return{x:e,y:r}},u.prototype.getContentHeight=function(r,t){t===void 0&&(t=1.15);var e=Array.isArray(this.text)?this.text.length:1,l=this.styles.fontSize/r*t,s=e*l+this.padding("vertical");return Math.max(s,this.styles.minCellHeight)},u.prototype.padding=function(r){var t=(0,p.parseSpacing)(this.styles.cellPadding,0);return r==="vertical"?t.top+t.bottom:r==="horizontal"?t.left+t.right:t[r]},u}();d.Cell=b;var m=function(){function u(r,t,e){this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.dataKey=r,this.raw=t,this.index=e}return u.prototype.getMaxCustomCellWidth=function(r){for(var t=0,e=0,l=r.allRows();e<l.length;e++){var s=l[e],n=s.cells[this.index];n&&typeof n.styles.cellWidth=="number"&&(t=Math.max(t,n.styles.cellWidth))}return t},u}();d.Column=m},356:function(T,d){Object.defineProperty(d,"__esModule",{value:!0}),d.assign=void 0;function H(F,w,p,P,i){if(F==null)throw new TypeError("Cannot convert undefined or null to object");for(var b=Object(F),m=1;m<arguments.length;m++){var u=arguments[m];if(u!=null)for(var r in u)Object.prototype.hasOwnProperty.call(u,r)&&(b[r]=u[r])}return b}d.assign=H},972:function(T,d,H){Object.defineProperty(d,"__esModule",{value:!0}),d.createTable=void 0;var F=H(744),w=H(260),p=H(324),P=H(796),i=H(356);function b(s,n){var f=new F.DocHandler(s),c=m(n,f.scaleFactor()),y=new w.Table(n,c);return(0,p.calculateWidths)(f,y),f.applyStyles(f.userStyles),y}d.createTable=b;function m(s,n){var f=s.content,c=e(f.columns);if(f.head.length===0){var y=r(c,"head");y&&f.head.push(y)}if(f.foot.length===0){var y=r(c,"foot");y&&f.foot.push(y)}var v=s.settings.theme,o=s.styles;return{columns:c,head:u("head",f.head,c,o,v,n),body:u("body",f.body,c,o,v,n),foot:u("foot",f.foot,c,o,v,n)}}function u(s,n,f,c,y,v){var o={},W=n.map(function(z,B){for(var h=0,a={},C=0,g=0,x=0,D=f;x<D.length;x++){var k=D[x];if(o[k.index]==null||o[k.index].left===0)if(g===0){var _=void 0;Array.isArray(z)?_=z[k.index-C-h]:_=z[k.dataKey];var M={};typeof _=="object"&&!Array.isArray(_)&&(M=(_==null?void 0:_.styles)||{});var j=l(s,k,B,y,c,v,M),A=new w.Cell(_,j,s);a[k.dataKey]=A,a[k.index]=A,g=A.colSpan-1,o[k.index]={left:A.rowSpan-1,times:g}}else g--,C++;else o[k.index].left--,g=o[k.index].times,h++}return new w.Row(z,B,s,a)});return W}function r(s,n){var f={};return s.forEach(function(c){if(c.raw!=null){var y=t(n,c.raw);y!=null&&(f[c.dataKey]=y)}}),Object.keys(f).length>0?f:null}function t(s,n){if(s==="head"){if(typeof n=="object")return n.header||n.title||null;if(typeof n=="string"||typeof n=="number")return n}else if(s==="foot"&&typeof n=="object")return n.footer;return null}function e(s){return s.map(function(n,f){var c,y,v;return typeof n=="object"?v=(y=(c=n.dataKey)!==null&&c!==void 0?c:n.key)!==null&&y!==void 0?y:f:v=f,new w.Column(v,n,f)})}function l(s,n,f,c,y,v,o){var W=(0,P.getTheme)(c),z;s==="head"?z=y.headStyles:s==="body"?z=y.bodyStyles:s==="foot"&&(z=y.footStyles);var B=(0,i.assign)({},W.table,W[s],y.styles,z),h=y.columnStyles[n.dataKey]||y.columnStyles[n.index]||{},a=s==="body"?h:{},C=s==="body"&&f%2===0?(0,i.assign)({},W.alternateRow,y.alternateRowStyles):{},g=(0,P.defaultStyles)(v),x=(0,i.assign)({},g,B,C,a);return(0,i.assign)(x,o)}},664:function(T,d,H){Object.defineProperty(d,"__esModule",{value:!0}),d.addPage=d.drawTable=void 0;var F=H(420),w=H(260),p=H(744),P=H(356),i=H(136),b=H(224);function m(h,a){var C=a.settings,g=C.startY,x=C.margin,D={x:x.left,y:g},k=a.getHeadHeight(a.columns)+a.getFootHeight(a.columns),_=g+x.bottom+k;if(C.pageBreak==="avoid"){var M=a.body,j=M.reduce(function(G,K){return G+K.height},0);_+=j}var A=new p.DocHandler(h);(C.pageBreak==="always"||C.startY!=null&&_>A.pageSize().height)&&(B(A),D.y=x.top),a.callWillDrawPageHooks(A,D);var Y=(0,P.assign)({},D);a.startPageNumber=A.pageNumber(),C.horizontalPageBreak?u(A,a,Y,D):(A.applyStyles(A.userStyles),(C.showHead==="firstPage"||C.showHead==="everyPage")&&a.head.forEach(function(G){return y(A,a,G,D,a.columns)}),A.applyStyles(A.userStyles),a.body.forEach(function(G,K){var Q=K===a.body.length-1;c(A,a,G,Q,Y,D,a.columns)}),A.applyStyles(A.userStyles),(C.showFoot==="lastPage"||C.showFoot==="everyPage")&&a.foot.forEach(function(G){return y(A,a,G,D,a.columns)})),(0,F.addTableBorder)(A,a,Y,D),a.callEndPageHooks(A,D),a.finalY=D.y,h.lastAutoTable=a,h.previousAutoTable=a,h.autoTable&&(h.autoTable.previous=a),A.applyStyles(A.userStyles)}d.drawTable=m;function u(h,a,C,g){var x=(0,b.calculateAllColumnsCanFitInPage)(h,a),D=a.settings;if(D.horizontalPageBreakBehaviour==="afterAllRows")x.forEach(function(j,A){h.applyStyles(h.userStyles),A>0?z(h,a,C,g,j.columns,!0):r(h,a,g,j.columns),t(h,a,C,g,j.columns),l(h,a,g,j.columns)});else for(var k=-1,_=x[0],M=function(){var j=k;if(_){h.applyStyles(h.userStyles);var A=_.columns;k>=0?z(h,a,C,g,A,!0):r(h,a,g,A),j=e(h,a,k+1,g,A),l(h,a,g,A)}var Y=j-k;x.slice(1).forEach(function(G){h.applyStyles(h.userStyles),z(h,a,C,g,G.columns,!0),e(h,a,k+1,g,G.columns,Y),l(h,a,g,G.columns)}),k=j};k<a.body.length-1;)M()}function r(h,a,C,g){var x=a.settings;h.applyStyles(h.userStyles),(x.showHead==="firstPage"||x.showHead==="everyPage")&&a.head.forEach(function(D){return y(h,a,D,C,g)})}function t(h,a,C,g,x){h.applyStyles(h.userStyles),a.body.forEach(function(D,k){var _=k===a.body.length-1;c(h,a,D,_,C,g,x)})}function e(h,a,C,g,x,D){h.applyStyles(h.userStyles),D=D??a.body.length;var k=Math.min(C+D,a.body.length),_=-1;return a.body.slice(C,k).forEach(function(M,j){var A=C+j===a.body.length-1,Y=W(h,a,A,g);M.canEntireRowFit(Y,x)&&(y(h,a,M,g,x),_=C+j)}),_}function l(h,a,C,g){var x=a.settings;h.applyStyles(h.userStyles),(x.showFoot==="lastPage"||x.showFoot==="everyPage")&&a.foot.forEach(function(D){return y(h,a,D,C,g)})}function s(h,a,C){var g=C.getLineHeight(h.styles.fontSize),x=h.padding("vertical"),D=Math.floor((a-x)/g);return Math.max(0,D)}function n(h,a,C,g){var x={};h.spansMultiplePages=!0,h.height=0;for(var D=0,k=0,_=C.columns;k<_.length;k++){var M=_[k],j=h.cells[M.index];if(j){Array.isArray(j.text)||(j.text=[j.text]);var A=new w.Cell(j.raw,j.styles,j.section);A=(0,P.assign)(A,j),A.text=[];var Y=s(j,a,g);j.text.length>Y&&(A.text=j.text.splice(Y,j.text.length));var G=g.scaleFactor(),K=g.getLineHeightFactor();j.contentHeight=j.getContentHeight(G,K),j.contentHeight>=a&&(j.contentHeight=a,A.styles.minCellHeight-=a),j.contentHeight>h.height&&(h.height=j.contentHeight),A.contentHeight=A.getContentHeight(G,K),A.contentHeight>D&&(D=A.contentHeight),x[M.index]=A}}var Q=new w.Row(h.raw,-1,h.section,x,!0);Q.height=D;for(var V=0,tt=C.columns;V<tt.length;V++){var M=tt[V],A=Q.cells[M.index];A&&(A.height=Q.height);var j=h.cells[M.index];j&&(j.height=h.height)}return Q}function f(h,a,C,g){var x=h.pageSize().height,D=g.settings.margin,k=D.top+D.bottom,_=x-k;a.section==="body"&&(_-=g.getHeadHeight(g.columns)+g.getFootHeight(g.columns));var M=a.getMinimumRowHeight(g.columns,h),j=M<C;if(M>_)return console.error("Will not be able to print row ".concat(a.index," correctly since it's minimum height is larger than page height")),!0;if(!j)return!1;var A=a.hasRowSpan(g.columns),Y=a.getMaxCellHeight(g.columns)>_;return Y?(A&&console.error("The content of row ".concat(a.index," will not be drawn correctly since drawing rows with a height larger than the page height and has cells with rowspans is not supported.")),!0):!(A||g.settings.rowPageBreak==="avoid")}function c(h,a,C,g,x,D,k){var _=W(h,a,g,D);if(C.canEntireRowFit(_,k))y(h,a,C,D,k);else if(f(h,C,_,a)){var M=n(C,_,a,h);y(h,a,C,D,k),z(h,a,x,D,k),c(h,a,M,g,x,D,k)}else z(h,a,x,D,k),c(h,a,C,g,x,D,k)}function y(h,a,C,g,x){g.x=a.settings.margin.left;for(var D=0,k=x;D<k.length;D++){var _=k[D],M=C.cells[_.index];if(!M){g.x+=_.width;continue}h.applyStyles(M.styles),M.x=g.x,M.y=g.y;var j=a.callCellHooks(h,a.hooks.willDrawCell,M,C,_,g);if(j===!1){g.x+=_.width;continue}v(h,M,g);var A=M.getTextPos();(0,i.default)(M.text,A.x,A.y,{halign:M.styles.halign,valign:M.styles.valign,maxWidth:Math.ceil(M.width-M.padding("left")-M.padding("right"))},h.getDocument()),a.callCellHooks(h,a.hooks.didDrawCell,M,C,_,g),g.x+=_.width}g.y+=C.height}function v(h,a,C){var g=a.styles;if(h.getDocument().setFillColor(h.getDocument().getFillColor()),typeof g.lineWidth=="number"){var x=(0,F.getFillStyle)(g.lineWidth,g.fillColor);x&&h.rect(a.x,C.y,a.width,a.height,x)}else typeof g.lineWidth=="object"&&(g.fillColor&&h.rect(a.x,C.y,a.width,a.height,"F"),o(h,a,C,g.lineWidth))}function o(h,a,C,g){var x,D,k,_;g.top&&(x=C.x,D=C.y,k=C.x+a.width,_=C.y,g.right&&(k+=.5*g.right),g.left&&(x-=.5*g.left),M(g.top,x,D,k,_)),g.bottom&&(x=C.x,D=C.y+a.height,k=C.x+a.width,_=C.y+a.height,g.right&&(k+=.5*g.right),g.left&&(x-=.5*g.left),M(g.bottom,x,D,k,_)),g.left&&(x=C.x,D=C.y,k=C.x,_=C.y+a.height,g.top&&(D-=.5*g.top),g.bottom&&(_+=.5*g.bottom),M(g.left,x,D,k,_)),g.right&&(x=C.x+a.width,D=C.y,k=C.x+a.width,_=C.y+a.height,g.top&&(D-=.5*g.top),g.bottom&&(_+=.5*g.bottom),M(g.right,x,D,k,_));function M(j,A,Y,G,K){h.getDocument().setLineWidth(j),h.getDocument().line(A,Y,G,K,"S")}}function W(h,a,C,g){var x=a.settings.margin.bottom,D=a.settings.showFoot;return(D==="everyPage"||D==="lastPage"&&C)&&(x+=a.getFootHeight(a.columns)),h.pageSize().height-g.y-x}function z(h,a,C,g,x,D){x===void 0&&(x=[]),D===void 0&&(D=!1),h.applyStyles(h.userStyles),a.settings.showFoot==="everyPage"&&!D&&a.foot.forEach(function(_){return y(h,a,_,g,x)}),a.callEndPageHooks(h,g);var k=a.settings.margin;(0,F.addTableBorder)(h,a,C,g),B(h),a.pageNumber++,a.pageCount++,g.x=k.left,g.y=k.top,C.y=k.top,a.callWillDrawPageHooks(h,g),a.settings.showHead==="everyPage"&&(a.head.forEach(function(_){return y(h,a,_,g,x)}),h.applyStyles(h.userStyles))}d.addPage=z;function B(h){var a=h.pageNumber();h.setPage(a+1);var C=h.pageNumber();return C===a?(h.addPage(),!0):!1}},224:function(T,d,H){Object.defineProperty(d,"__esModule",{value:!0}),d.calculateAllColumnsCanFitInPage=void 0;var F=H(420);function w(P,i,b){var m;b===void 0&&(b={});var u=(0,F.getPageAvailableWidth)(P,i),r=new Map,t=[],e=[],l=[];i.settings.horizontalPageBreakRepeat,Array.isArray(i.settings.horizontalPageBreakRepeat)?l=i.settings.horizontalPageBreakRepeat:(typeof i.settings.horizontalPageBreakRepeat=="string"||typeof i.settings.horizontalPageBreakRepeat=="number")&&(l=[i.settings.horizontalPageBreakRepeat]),l.forEach(function(c){var y=i.columns.find(function(v){return v.dataKey===c||v.index===c});y&&!r.has(y.index)&&(r.set(y.index,!0),t.push(y.index),e.push(i.columns[y.index]),u-=y.wrappedWidth)});for(var s=!0,n=(m=b==null?void 0:b.start)!==null&&m!==void 0?m:0;n<i.columns.length;){if(r.has(n)){n++;continue}var f=i.columns[n].wrappedWidth;if(s||u>=f)s=!1,t.push(n),e.push(i.columns[n]),u-=f;else break;n++}return{colIndexes:t,columns:e,lastIndex:n-1}}function p(P,i){for(var b=[],m=0;m<i.columns.length;m++){var u=w(P,i,{start:m});u.columns.length&&(b.push(u),m=u.lastIndex)}return b}d.calculateAllColumnsCanFitInPage=p},324:function(T,d,H){Object.defineProperty(d,"__esModule",{value:!0}),d.ellipsize=d.resizeColumns=d.calculateWidths=void 0;var F=H(420);function w(t,e){p(t,e);var l=[],s=0;e.columns.forEach(function(f){var c=f.getMaxCustomCellWidth(e);c?f.width=c:(f.width=f.wrappedWidth,l.push(f)),s+=f.width});var n=e.getWidth(t.pageSize().width)-s;n&&(n=P(l,n,function(f){return Math.max(f.minReadableWidth,f.minWidth)})),n&&(n=P(l,n,function(f){return f.minWidth})),n=Math.abs(n),!e.settings.horizontalPageBreak&&n>.1/t.scaleFactor()&&(n=n<1?n:Math.round(n),console.warn("Of the table content, ".concat(n," units width could not fit page"))),b(e),m(e,t),i(e)}d.calculateWidths=w;function p(t,e){var l=t.scaleFactor(),s=e.settings.horizontalPageBreak,n=(0,F.getPageAvailableWidth)(t,e);e.allRows().forEach(function(f){for(var c=0,y=e.columns;c<y.length;c++){var v=y[c],o=f.cells[v.index];if(o){var W=e.hooks.didParseCell;e.callCellHooks(t,W,o,f,v,null);var z=o.padding("horizontal");o.contentWidth=(0,F.getStringWidth)(o.text,o.styles,t)+z;var B=(0,F.getStringWidth)(o.text.join(" ").split(/[^\S\u00A0]+/),o.styles,t);if(o.minReadableWidth=B+o.padding("horizontal"),typeof o.styles.cellWidth=="number")o.minWidth=o.styles.cellWidth,o.wrappedWidth=o.styles.cellWidth;else if(o.styles.cellWidth==="wrap"||s===!0)o.contentWidth>n?(o.minWidth=n,o.wrappedWidth=n):(o.minWidth=o.contentWidth,o.wrappedWidth=o.contentWidth);else{var h=10/l;o.minWidth=o.styles.minCellWidth||h,o.wrappedWidth=o.contentWidth,o.minWidth>o.wrappedWidth&&(o.wrappedWidth=o.minWidth)}}}}),e.allRows().forEach(function(f){for(var c=0,y=e.columns;c<y.length;c++){var v=y[c],o=f.cells[v.index];if(o&&o.colSpan===1)v.wrappedWidth=Math.max(v.wrappedWidth,o.wrappedWidth),v.minWidth=Math.max(v.minWidth,o.minWidth),v.minReadableWidth=Math.max(v.minReadableWidth,o.minReadableWidth);else{var W=e.styles.columnStyles[v.dataKey]||e.styles.columnStyles[v.index]||{},z=W.cellWidth||W.minCellWidth;z&&typeof z=="number"&&(v.minWidth=z,v.wrappedWidth=z)}o&&(o.colSpan>1&&!v.minWidth&&(v.minWidth=o.minWidth),o.colSpan>1&&!v.wrappedWidth&&(v.wrappedWidth=o.minWidth))}})}function P(t,e,l){for(var s=e,n=t.reduce(function(h,a){return h+a.wrappedWidth},0),f=0;f<t.length;f++){var c=t[f],y=c.wrappedWidth/n,v=s*y,o=c.width+v,W=l(c),z=o<W?W:o;e-=z-c.width,c.width=z}if(e=Math.round(e*1e10)/1e10,e){var B=t.filter(function(h){return e<0?h.width>l(h):!0});B.length&&(e=P(B,e,l))}return e}d.resizeColumns=P;function i(t){for(var e={},l=1,s=t.allRows(),n=0;n<s.length;n++)for(var f=s[n],c=0,y=t.columns;c<y.length;c++){var v=y[c],o=e[v.index];if(l>1)l--,delete f.cells[v.index];else if(o)o.cell.height+=f.height,l=o.cell.colSpan,delete f.cells[v.index],o.left--,o.left<=1&&delete e[v.index];else{var W=f.cells[v.index];if(!W)continue;if(W.height=f.height,W.rowSpan>1){var z=s.length-n,B=W.rowSpan>z?z:W.rowSpan;e[v.index]={cell:W,left:B,row:f}}}}}function b(t){for(var e=t.allRows(),l=0;l<e.length;l++)for(var s=e[l],n=null,f=0,c=0,y=0;y<t.columns.length;y++){var v=t.columns[y];if(c-=1,c>1&&t.columns[y+1])f+=v.width,delete s.cells[v.index];else if(n){var o=n;delete s.cells[v.index],n=null,o.width=v.width+f}else{var o=s.cells[v.index];if(!o)continue;if(c=o.colSpan,f=0,o.colSpan>1){n=o,f+=v.width;continue}o.width=v.width+f}}}function m(t,e){for(var l={count:0,height:0},s=0,n=t.allRows();s<n.length;s++){for(var f=n[s],c=0,y=t.columns;c<y.length;c++){var v=y[c],o=f.cells[v.index];if(o){e.applyStyles(o.styles,!0);var W=o.width-o.padding("horizontal");if(o.styles.overflow==="linebreak")o.text=e.splitTextToSize(o.text,W+1/e.scaleFactor(),{fontSize:o.styles.fontSize});else if(o.styles.overflow==="ellipsize")o.text=u(o.text,W,o.styles,e,"...");else if(o.styles.overflow==="hidden")o.text=u(o.text,W,o.styles,e,"");else if(typeof o.styles.overflow=="function"){var z=o.styles.overflow(o.text,W);typeof z=="string"?o.text=[z]:o.text=z}o.contentHeight=o.getContentHeight(e.scaleFactor(),e.getLineHeightFactor());var B=o.contentHeight/o.rowSpan;o.rowSpan>1&&l.count*l.height<B*o.rowSpan?l={height:B,count:o.rowSpan}:l&&l.count>0&&l.height>B&&(B=l.height),B>f.height&&(f.height=B)}}l.count--}}function u(t,e,l,s,n){return t.map(function(f){return r(f,e,l,s,n)})}d.ellipsize=u;function r(t,e,l,s,n){var f=1e4*s.scaleFactor();if(e=Math.ceil(e*f)/f,e>=(0,F.getStringWidth)(t,l,s))return t;for(;e<(0,F.getStringWidth)(t+n,l,s)&&!(t.length<=1);)t=t.substring(0,t.length-1);return t.trim()+n}},964:function(T){if(typeof R>"u"){var d=new Error("Cannot find module 'undefined'");throw d.code="MODULE_NOT_FOUND",d}T.exports=R}},O={};function L(T){var d=O[T];if(d!==void 0)return d.exports;var H=O[T]={exports:{}};return E[T].call(H.exports,H,H.exports,L),H.exports}var N={};return function(){var T=N;Object.defineProperty(T,"__esModule",{value:!0}),T.Cell=T.Column=T.Row=T.Table=T.CellHookData=T.__drawTable=T.__createTable=T.applyPlugin=void 0;var d=L(340),H=L(776),F=L(664),w=L(972),p=L(260);Object.defineProperty(T,"Table",{enumerable:!0,get:function(){return p.Table}});var P=L(172);Object.defineProperty(T,"CellHookData",{enumerable:!0,get:function(){return P.CellHookData}});var i=L(260);Object.defineProperty(T,"Cell",{enumerable:!0,get:function(){return i.Cell}}),Object.defineProperty(T,"Column",{enumerable:!0,get:function(){return i.Column}}),Object.defineProperty(T,"Row",{enumerable:!0,get:function(){return i.Row}});function b(e){(0,d.default)(e)}T.applyPlugin=b;function m(e,l){var s=(0,H.parseInput)(e,l),n=(0,w.createTable)(e,s);(0,F.drawTable)(e,n)}function u(e,l){var s=(0,H.parseInput)(e,l);return(0,w.createTable)(e,s)}T.__createTable=u;function r(e,l){(0,F.drawTable)(e,l)}T.__drawTable=r;try{var t=L(964);t.jsPDF&&(t=t.jsPDF),b(t)}catch{}T.default=m}(),N}()})})(ot);const st={orientation:"portrait",unit:"mm",format:"letter",compress:!0},J={top:20,right:20,bottom:20,left:20},$={title:{size:22,weight:"bold"},heading1:{size:18,weight:"bold"},heading2:{size:14,weight:"bold"},heading3:{size:12,weight:"bold"},body:{size:10,weight:"normal"},small:{size:8,weight:"normal"}},U={primary:[59,130,246],success:[16,185,129],warning:[245,158,11],danger:[239,68,68],gray:[107,114,128],lightGray:[243,244,246],darkGray:[31,41,55],white:[255,255,255],black:[0,0,0]};function ft(S={}){return new it({...st,...S})}function ht(S,I,R=null,E={}){const{margin:O=J,titleColor:L=U.primary,subtitleColor:N=U.gray,addTimestamp:T=!0}=E,d=S.internal.pageSize.getWidth();let H=O.top;return S.setFillColor(...L),S.rect(0,0,d,30,"F"),S.setTextColor(...U.white),S.setFontSize($.title.size),S.setFont("helvetica","bold"),S.text(I,O.left,H),H+=10,R&&(S.setFontSize($.body.size),S.setFont("helvetica","normal"),S.text(R,O.left,H),H+=8),S.setTextColor(...U.black),H=40,T&&(S.setFontSize($.small.size),S.setFont("helvetica","normal"),S.setTextColor(...U.gray),S.text(`Generated: ${new Date().toLocaleString()}`,O.left,H),H+=10),H}function et(S,I,R={}){const{margin:E=J}=R,O=S.internal.pageSize.getHeight(),L=S.internal.pageSize.getWidth();S.setFontSize($.small.size),S.setFont("helvetica","italic"),S.setTextColor(...U.gray);const N=`Page ${S.internal.getCurrentPageInfo().pageNumber}`;S.text(N,L-E.right,O-10,{align:"right"}),I&&S.text(I,E.left,O-10)}function Z(S,I,R,E=1,O={}){const{margin:L=J,color:N=U.darkGray}=O,T=S.internal.pageSize.getHeight(),d=S.internal.pageSize.getWidth(),H=d-(L.left+L.right);R>T-L.bottom-20&&(S.addPage(),R=L.top),R+=8;const w={1:$.heading1,2:$.heading2,3:$.heading3}[E]||$.heading2;S.setFontSize(w.size),S.setFont("helvetica",w.weight),S.setTextColor(...N);const p=S.splitTextToSize(I,H);return S.text(p,L.left,R),R+=p.length*(w.size/2+2),E===1&&(S.setDrawColor(...U.lightGray),S.setLineWidth(.5),S.line(L.left,R+2,d-L.right,R+2),R+=5),R+=5,S.setTextColor(...U.black),R}function X(S,I,R,E={}){const{margin:O=J,fontSize:L=$.body.size,color:N=U.black,fontWeight:T="normal"}=E,d=S.internal.pageSize.getHeight(),F=S.internal.pageSize.getWidth()-(O.left+O.right);return S.setFontSize(L),S.setFont("helvetica",T),S.setTextColor(...N),S.splitTextToSize(I,F).forEach(p=>{R>d-O.bottom&&(S.addPage(),R=O.top),S.text(p,O.left,R),R+=L/2+2}),R+=5,R}function ut(S,I,R,E,O={}){const{theme:L="grid",headStyles:N={fillColor:U.primary,textColor:U.white,fontStyle:"bold",fontSize:10,cellPadding:4},bodyStyles:T={fontSize:9,cellPadding:4},alternateRowStyles:d={fillColor:U.lightGray},columnStyles:H={},margin:F=J}=O;return S.autoTable({head:[I],body:R,startY:E,theme:L,headStyles:N,bodyStyles:T,alternateRowStyles:d,columnStyles:H,margin:{top:F.top,right:F.right,bottom:F.bottom,left:F.left},styles:{overflow:"linebreak",cellWidth:"wrap",fontSize:9,cellPadding:4,valign:"middle"},didDrawPage:function(w){et(S,"DOT Corridor Communicator",{margin:F})}}),S.lastAutoTable.finalY+10}async function gt(S,I,R,E={}){const{margin:O=J,width:L=null,scale:N=2,backgroundColor:T="#ffffff"}=E,d=S.internal.pageSize.getWidth(),H=L||d-(O.left+O.right);try{const F=await at(I,{scale:N,useCORS:!0,logging:!1,backgroundColor:T,imageTimeout:0,removeContainer:!0,letterRendering:!0,allowTaint:!0}),w=F.toDataURL("image/png"),p=H,P=F.height*p/F.width,i=S.internal.pageSize.getHeight();return R+P>i-O.bottom&&(S.addPage(),R=O.top),S.addImage(w,"PNG",O.left,R,p,P),R+P+10}catch(F){return console.error("Error converting HTML to canvas:",F),R}}function dt(S,I,R,E={}){const{margin:O=J}=E,L=I.split(`
`);for(const N of L){const T=N.trim();if(!T){R+=3;continue}if(T.startsWith("### "))R=Z(S,T.substring(4),R,3,{margin:O});else if(T.startsWith("## "))R=Z(S,T.substring(3),R,2,{margin:O});else if(T.startsWith("# "))R=Z(S,T.substring(2),R,1,{margin:O});else if(T.includes("**")){const d=T.replace(/\*\*/g,"");R=X(S,d,R,{margin:O,fontWeight:"bold"})}else if(T.startsWith("- ")||T.startsWith("* ")){const d="â€¢ "+T.substring(2);R=X(S,d,R,{margin:O})}else{const d=T.replace(/`([^`]+)`/g,"$1").replace(/\*([^*]+)\*/g,"$1");R=X(S,d,R,{margin:O})}}return R}function vt(S,I,R,E,O=U.primary,L={}){const{fontSize:N=8,padding:T=2,borderRadius:d=2}=L;S.setFontSize(N),S.setFont("helvetica","bold");const F=S.getTextWidth(I)+T*2,w=N+T;return S.setFillColor(...O),S.roundedRect(R,E-N+2,F,w,d,d,"F"),S.setTextColor(...U.white),S.text(I,R+T,E),S.setTextColor(...U.black),R+F+5}function pt(S,I,R,E,O,L,N,T=U.primary){S.setFillColor(...U.lightGray),S.roundedRect(E,O,L,N,2,2,"F"),S.setFillColor(...T),S.rect(E,O,3,N,"F"),S.setFontSize(8),S.setFont("helvetica","normal"),S.setTextColor(...U.gray),S.text(I,E+8,O+8),S.setFontSize(16),S.setFont("helvetica","bold"),S.setTextColor(...T),S.text(String(R),E+8,O+N-8),S.setTextColor(...U.black)}function ct(S,I){I.endsWith(".pdf")||(I+=".pdf");const R=new Date().toISOString().split("T")[0],E=I.replace(".pdf",`-${R}.pdf`);S.save(E)}const wt={createPDF:ft,addHeader:ht,addFooter:et,addSectionHeading:Z,addParagraph:X,addTable:ut,addHTMLElement:gt,processMarkdownForPDF:dt,addBadge:vt,addStatsCard:pt,savePDF:ct,COLORS:U,DEFAULT_FONTS:$,DEFAULT_MARGINS:J};export{U as COLORS,$ as DEFAULT_FONTS,J as DEFAULT_MARGINS,st as DEFAULT_PDF_CONFIG,vt as addBadge,et as addFooter,gt as addHTMLElement,ht as addHeader,X as addParagraph,Z as addSectionHeading,pt as addStatsCard,ut as addTable,ft as createPDF,wt as default,dt as processMarkdownForPDF,ct as savePDF};
